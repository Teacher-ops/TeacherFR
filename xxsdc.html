<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Discours direct et indirect – 3AC (Relaxed MCQ Slides with Cool Sound & Randomized)</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;700;900&display=swap" rel="stylesheet">
<style>
  :root{
    --bg: linear-gradient(140deg, #eaf6f3 0%, #f8eef3 40%, #fdf8ec 90%, #e4edfb 100%);
    --card: rgba(255,255,255,0.72);
    --ink: #222c32;
    --muted: #8eb6b6;
    --primary: #84beb7;
    --accent: #a992de;
    --warn:  #fcb9b2;
    --pill:  #fff8fa;
    --good:  #51de98;
    --bad:   #e57676;
    --status-bg-good: linear-gradient(90deg,#d8fbe6 0%, #51de98 100%);
    --status-bg-bad: linear-gradient(90deg,#fee0e2 0%, #e57676 100%);
    --font: 'Poppins', 'Segoe UI', Arial, sans-serif;
    --base-font: clamp(20px, 2vw, 30px);
  }
  html,body{margin:0;padding:0;background:var(--bg);color:var(--ink);font-family:var(--font);font-size:var(--base-font);}
  .deck{position:relative;height:100svh;width:100%;overflow:hidden;}
  .slide{position:absolute;inset:0;display:flex;flex-direction:column;justify-content:center;align-items:center;
    padding: clamp(16px,5vw,56px);gap: clamp(16px,2vw,38px);transform:translateX(100%);opacity:0;
    transition:transform .5s cubic-bezier(.7,.1,.6,1.3),opacity .4s;}
  .slide.active{transform:translateX(0);opacity:1;}
  .slide.left{transform:translateX(-100%);}
  .card{
    background:var(--card);backdrop-filter:blur(5px);
    border-radius:34px;box-shadow:0 10px 34px rgba(63,88,118,.09);padding:clamp(18px,4vw,54px);width:min(960px,98%);
    border:1px solid #eaeaea;
  }
  h1{margin:.1em 0;font-size:clamp(38px,7vw,56px);font-weight:900;letter-spacing:.1px;color:var(--accent);}
  h2{margin:0 0 14px 0;font-size:clamp(26px,5vw,40px);font-weight:700;color:var(--primary);}
  p{margin:.6em 0;}
  .k{color:var(--muted);font-size:1em;font-weight:400;}
  .grid{display:grid;gap:18px;grid-template-columns: repeat(2,minmax(0,1fr))}
  .ex{
    background:rgba(255,255,255,0.96);border-radius:18px;padding:16px;font-size:1em;
    box-shadow:0 1px 14px rgba(156,191,175,.08);border:1px solid #dfeeed;
  }
  /* Quiz UI */
  .choices{display:grid;gap:18px;margin-top:.7em;}
  .choice{display:flex;align-items:flex-start;gap:18px;background:rgba(247,246,255,0.98);border:none;
    border-radius:18px;padding:20px;font-size:1em;cursor:pointer;box-shadow:0 4px 32px rgba(138,116,210,.06);
    transition:background .2s, box-shadow .2s;}
  .choice:hover, .choice:focus-within{background:#ece9fc;box-shadow:0 0 0 4px #b5bcf759;}
  .choice input{width:28px;height:28px;accent-color:var(--primary);margin-top:2px;flex:0 0 28px;}
  .status{font-family:var(--font);font-weight:800;font-size:1.4em;min-height:1.15em;padding:8px 24px;border-radius:16px;margin-top:10px;}
  .status.good{color:var(--good);background:var(--status-bg-good);border:2px solid #b5edce;}
  .status.bad{color:var(--bad);background:var(--status-bg-bad);border:2px solid #fed7d8;}
  /* Widgets/pills */
  .hud{position:fixed;inset:22px 22px auto auto;display:flex;align-items:center;gap:18px;z-index:10;
    background:var(--pill);border-radius:999px;padding:16px 34px 15px 24px;border:1px solid #dfeeed;
    color:var(--primary);box-shadow: 0 4px 26px rgba(129,167,156,0.09);
    font-weight:700; font-size:.98em;}
  .pill{background:none;}
  /* Nav */
  .nav{position:fixed;inset:auto 0 28px 0;display:flex;justify-content:center;gap:18px;z-index:9;}
  .btn{border:0;border-radius:18px;padding:18px 34px;font-weight:700;font-size:1.12em;cursor:pointer;
    background:linear-gradient(120deg,#fdf8ec,#eaf6f3,#e4edfb 78%);
    color:var(--accent);box-shadow:0 8px 30px rgba(126,146,206,.09);margin-top:10px;transition:box-shadow .2s;}
  .btn.alt{background:linear-gradient(110deg,#84beb7,#a492d9 100%);
    color:#fff;}
  .btn.ghost{background:rgba(255,255,255,0.96);color:#84beb7;border:2px solid #a0e4d9;}
  .btn:active{box-shadow:0 2px 4px #aacfe5;}
  /* Progress bar */
  .progress{position:fixed;left:0;right:0;top:0;height:8px;background:rgba(158,164,214,.12);border-radius:4px;}
  .bar{height:100%;width:0%;background:linear-gradient(90deg,#84beb7,#a492d9 60%);border-radius:2px;}
  /* Mobile */
  @media (max-width:900px){
    .grid{grid-template-columns:1fr;}
    .card{padding:7vw 4vw;}
    h1,h2{font-size:clamp(22px,10vw,57px);}
  }
</style>
</head>
<body>
<audio id="sound-good" src="https://actions.google.com/sounds/v1/cartoon/wood_plank_flicks.ogg" preload="auto"></audio>
<audio id="sound-bad" src="https://actions.google.com/sounds/v1/cartoon/cartoon_boing.ogg" preload="auto"></audio>

<div class="progress"><div class="bar" id="bar"></div></div>
<div class="hud" role="status" aria-live="polite">
  <span class="pill">Score: <strong id="scoreVal">0</strong>/<span id="scoreMax">0</span></span>
  <span class="pill">Slide <strong id="slideNo">1</strong>/<span id="slideTotal">1</span></span>
</div>
<div class="deck" id="deck"></div>
<div class="nav">
  <button class="btn ghost" id="prevBtn" type="button">⟵ Précédent</button>
  <button class="btn alt" id="nextBtn" type="button">Suivant ⟶</button>
</div>
<script>
const originalQuizData = [
  {
    q:"Transforme au discours indirect : « Je suis fatigué », dit-il.",
    options:[
      {t:"Il dit qu’il est fatigué.",ok:true},
      {t:"Il dit qu’il était fatigué.",ok:false},
      {t:"Il a dit qu’il est fatigué.",ok:false},
      {t:"Il a dit: « Je suis fatigué. »",ok:false}
    ]
  },
  {
    q:"Transforme au discours indirect : « Ils avaient vu un film », raconte-t-elle.",
    options:[
      {t:"Elle raconte qu’ils avaient vu un film.",ok:true},
      {t:"Elle raconte qu’ils ont vu un film.",ok:false},
      {t:"Elle raconte qu’ils verraient un film.",ok:false},
      {t:"Elle a raconté qu’ils avaient vu un film.",ok:false}
    ]
  },
  {
    q:"Transforme au discours indirect : « Vous passerez l’examen demain », annonce le professeur.",
    options:[
      {t:"Le professeur annonce qu’ils passeraient l’examen le lendemain.",ok:true},
      {t:"Le professeur annonce qu’ils passeront l’examen demain.",ok:false},
      {t:"Le professeur annonça qu’ils passeraient l’examen le lendemain.",ok:false},
      {t:"Le professeur dit: « Vous passerez l’examen demain. »",ok:false}
    ]
  },
  {
    q:"Transforme au discours indirect : « Faites vos devoirs », ordonne le père.",
    options:[
      {t:"Le père ordonne de faire leurs devoirs.",ok:true},
      {t:"Le père a ordonné de faire leurs devoirs.",ok:false},
      {t:"Le père ordonne qu’ils fassent leurs devoirs.",ok:false},
      {t:"Le père ordonne: « Faites vos devoirs. »",ok:false}
    ]
  }
];
function shuffleArray(arr){
  for(let i=arr.length-1; i>0; i--){
    const j=Math.floor(Math.random()*(i+1));
    [arr[i],arr[j]] = [arr[j],arr[i]];
  }
  return arr;
}
const deck=document.getElementById("deck"),
      scoreVal=document.getElementById("scoreVal"),
      scoreMax=document.getElementById("scoreMax"),
      slideNo=document.getElementById("slideNo"),
      slideTotal=document.getElementById("slideTotal"),
      bar=document.getElementById("bar"),
      prevBtn=document.getElementById("prevBtn"),
      nextBtn=document.getElementById("nextBtn"),
      soundGood=document.getElementById("sound-good"),
      soundBad=document.getElementById("sound-bad");
let current=0;
function getShuffledQuiz(){
  return originalQuizData.map(item => {
    const correct = item.options.filter(o => o.ok);
    const incorrect = item.options.filter(o => !o.ok);
    shuffleArray(incorrect);
    const allOptions = [];
    const correctPos = Math.floor(Math.random() * (incorrect.length + 1));
    let incorrectIndex=0;
    for (let i = 0; i < incorrect.length + 1; i++){
      if(i === correctPos) {
        allOptions.push(correct[0]);
      } else {
        allOptions.push(incorrect[incorrectIndex++]);
      }
    }
    return {...item, options: allOptions};
  });
}
let quizData = getShuffledQuiz();
function makeSlide(el){
  el.className="slide";
  const wrap=document.createElement("div");
  wrap.className="card";
  el.appendChild(wrap);
  return wrap;
}
function renderDeck(){
  deck.innerHTML="";
  const s0=document.createElement("section"),
        c0=makeSlide(s0);
  c0.innerHTML=`
    <h1>Discours direct et indirect – 3AC</h1>
    <p class="k">Cours synthétique + quiz à choix, correction immédiate, ambiance relax.</p>
    <div class="grid">
      <div class="ex"><div class="k">Direct</div><div>« Je viendrai demain », dit Sara.</div></div>
      <div class="ex"><div class="k">Indirect</div><div>Sara dit qu’elle viendrait le lendemain.</div></div>
    </div>
    <p style="color:var(--primary)">Utilisez ⟵ ⟶ ou les boutons ci-dessous pour naviguer les slides.<br />Choisissez une réponse à chaque question, le badge affiche le score.</p>
  `;
  deck.appendChild(s0);
  quizData.forEach((item,idx)=>{
    const s=document.createElement("section"),
          c=makeSlide(s),
          qIdPrefix=`q${idx}`;
    const h2=document.createElement("h2");
    h2.textContent=`Question ${idx+1}`;
    c.appendChild(h2);
    const p=document.createElement("p");
    p.style.fontWeight="700";
    p.textContent=item.q;
    c.appendChild(p);
    const choices=document.createElement("div");
    choices.className="choices";
    item.options.forEach((op,j)=>{
      const row=document.createElement("label");
      row.className="choice";
      const input=document.createElement("input");
      input.type="radio";
      input.name=qIdPrefix;
      input.dataset.correct=op.ok?"1":"0";
      input.addEventListener("change",handleChoice);
      const span=document.createElement("span");
      span.textContent=op.t;
      row.appendChild(input);
      row.appendChild(span);
      choices.appendChild(row);
    });
    c.appendChild(choices);
    const status=document.createElement("div");
    status.className="status";
    status.id=`s${idx}`;
    status.textContent="—";
    c.appendChild(status);
    deck.appendChild(s);
  });
  const sEnd=document.createElement("section"),
        cEnd=makeSlide(sEnd);
  cEnd.innerHTML=`
    <h2>Bilan relax 🧘</h2>
    <p>Votre score final s’affiche dans le badge (coin en haut à droite).</p>
    <div style="display:flex; gap:14px; margin-top:14px;">
      <button class="btn" id="resetAll" type="button">Réessayer tout</button>
    </div>
  `;
  deck.appendChild(sEnd);
  scoreMax.textContent=quizData.length;
  slideTotal.textContent=deck.children.length;
  activate(0);
  cEnd.querySelector("#resetAll").addEventListener("click",()=>{
    document.querySelectorAll('input[type="radio"]').forEach(i=>i.checked=false);
    document.querySelectorAll('.status').forEach(s=>{s.textContent="—";s.className="status";});
    resetPlayedFlags();
    scoreVal.textContent="0";
    quizData = getShuffledQuiz();
    renderDeck();
    activate(0);
  });
}
function handleChoice(e){
  if(e.target._played) return;
  e.target._played = true;
  updateScore();
}
function updateScore(){
  let score=0;
  quizData.forEach((_,idx)=>{
    const sel=document.querySelector(`input[name="q${idx}"]:checked`);
    const s=document.getElementById(`s${idx}`);
    if(!s) return;
    if(!sel){
      s.textContent="—";
      s.className="status";
      return;
    }
    if(sel.dataset.correct==="1"){
      s.textContent="✓";
      s.className="status good";
      if(!sel._soundPlayed){
        soundGood.currentTime=0;
        soundGood.play();
        sel._soundPlayed=true;
      }
      score+=1;
    } else{
      s.textContent="✗";
      s.className="status bad";
      if(!sel._soundPlayed){
        soundBad.currentTime=0;
        soundBad.play();
        sel._soundPlayed=true;
      }
    }
  });
  scoreVal.textContent=score;
}
function resetPlayedFlags(){
  document.querySelectorAll('input[type="radio"]').forEach(i => { i._played = false; i._soundPlayed = false; });
}
function activate(n){
  current=n;
  deck.querySelectorAll(".slide").forEach((slide,idx)=>{
    slide.className="slide";
    if(idx===n)slide.classList.add("active");
    else if(idx<n)slide.classList.add("left");
  });
  slideNo.textContent=n+1;
  bar.style.width=`${100*n/(deck.children.length-1)}%`;
  prevBtn.disabled=n<=0; nextBtn.disabled=n>=deck.children.length-1;
}
prevBtn.addEventListener("click",()=>{if(current>0)activate(current-1);});
nextBtn.addEventListener("click",()=>{if(current<deck.children.length-1)activate(current+1);});
window.addEventListener("keydown",e=>{
  if(e.key==="ArrowLeft"){prevBtn.click();}
  else if(e.key==="ArrowRight"){nextBtn.click();}
});
renderDeck();
</script>
</body>
</html>
